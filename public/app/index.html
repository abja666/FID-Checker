<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>FID Checker — Mini App</title>
    <style>
      :root { color-scheme: dark light }
      body { margin:0; min-height:100svh; display:grid; place-items:center;
             background:#0b0b14; color:#e5e7eb; font:16px/1.6 system-ui }
      .card { width:min(480px, 92vw); background:#111827; border:1px solid #232535;
              border-radius:16px; padding:20px 22px; }
      h1 { margin:0 0 8px; font-size:22px }
      p  { margin:0 0 10px; color:#9aa3b2 }
      button { padding:10px 14px; border-radius:10px; background:#1f2937; color:#fff;
               border:1px solid #374151; cursor:pointer }
      pre { background:#0b0e19; border:1px solid #232535; border-radius:12px; padding:12px;
            overflow:auto; font-size:13px }
      .ok { color:#a7f3d0 }
      .err { color:#fca5a5 }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Connect Farcaster</h1>
      <p>Klik tombol di bawah untuk “connect”. Setelah izin diberikan, FID kamu akan tampil.</p>
      <button id="connect">Connect wallet</button>
      <p id="status" style="margin-top:10px;">Ready</p>
      <pre id="out" hidden></pre>
    </div>

    <script type="module">
      // Mini App SDK dipanggil hanya saat dibuka dari Warpcast Mini App modal.
      import { sdk } from 'https://unpkg.com/@farcaster/miniapp-sdk?module';

      sdk.actions.ready();

      const statusEl = document.getElementById('status');
      const outEl = document.getElementById('out');
      document.getElementById('connect').onclick = async () => {
        try {
          statusEl.textContent = 'Requesting permission...';
          const auth = await sdk.actions.signIn(); // minta izin dari user
          // auth.user: { fid, username, displayName, pfpUrl, ... }
          statusEl.innerHTML = 'Connected <span class="ok">✅</span>';
          outEl.hidden = false;
          outEl.textContent = JSON.stringify(
            { fid: auth.user.fid, username: auth.user.username },
            null, 2
          );
        } catch (e) {
          statusEl.innerHTML = 'Canceled/failed <span class="err">✖</span>';
          outEl.hidden = false;
          outEl.textContent = (e && e.message) ? e.message : String(e);
        }
      };
    </script>
  </body>
</html>
